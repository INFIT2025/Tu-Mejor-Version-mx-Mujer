<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicia Tu Mejor Versi√≥n - INFIT (M√©xico)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs (Compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <!-- Confetti Effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        infit: {
                            blue: '#0066FF',
                            dark: '#0a0a0a',
                            gold: '#FFD700',
                            pink: '#ec4899',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Oswald', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #050505;
            background-image: radial-gradient(circle at 50% 0%, #111 0%, #050505 70%);
            color: #f5f5f5;
            overflow-x: hidden;
        }
        .glass-panel {
            background: rgba(15, 15, 15, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }
        .combo-card {
            background: linear-gradient(180deg, rgba(236, 72, 153, 0.05) 0%, rgba(5, 5, 5, 1) 100%);
            border: 1px solid #ec4899;
            box-shadow: 0 0 30px rgba(236, 72, 153, 0.15);
            transform: scale(1.02);
            position: relative;
            z-index: 10;
        }
        .input-field {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #333;
            transition: all 0.3s ease;
            color: white;
        }
        .input-field:focus {
            border-color: #ec4899;
            outline: none;
            box-shadow: 0 0 10px rgba(236, 72, 153, 0.2);
        }
        .day-checkbox:checked + div {
            background-color: #ec4899;
            color: white;
            font-weight: bold;
        }
        #editor-panel {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        #editor-panel.open {
            transform: translateX(0);
        }
        optgroup {
            background-color: #1a1a1a;
            color: #ffffff;
            font-style: normal;
            font-weight: bold;
        }
        .admin-only {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col font-sans selection:bg-infit-pink selection:text-white">

    <!-- Bot√≥n Flotante de Edici√≥n (SOLO ADMIN) -->
    <button id="admin-trigger" onclick="toggleEditor()" class="admin-only fixed bottom-4 right-4 z-[90] bg-gray-800 text-gray-400 p-3 rounded-full shadow-lg hover:text-white hover:bg-gray-700 transition-all border border-infit-pink" title="Editar Contenido">
        <i class="fas fa-cog text-xl"></i>
    </button>

    <!-- Panel de Edici√≥n Lateral (SOLO ADMIN) -->
    <div id="editor-panel" class="admin-only fixed top-0 right-0 h-full w-80 bg-[#111] border-l border-gray-800 z-[100] shadow-2xl p-6 overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-infit-pink font-heading font-bold uppercase">Editor de Contenido</h3>
            <button onclick="toggleEditor()" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="space-y-4 text-xs">
            <div class="bg-red-900/20 p-2 rounded border border-red-500/30 mb-4">
                <p class="text-red-200">üîí <strong>Modo Administrador Activo</strong><br>Este panel no es visible para los clientes.</p>
            </div>

            <div>
                <label class="block text-gray-500 mb-1">Texto Promoci√≥n (Header)</label>
                <input type="text" id="edit-promo" class="input-field w-full p-2 rounded" oninput="updateContent()">
            </div>
            
            <div class="border-t border-gray-700 pt-4 mt-4">
                <h4 class="text-white font-bold mb-2">Precios (MXN)</h4>
                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label class="block text-gray-500">Nutrici√≥n</label>
                        <input type="number" id="edit-price-nutri" class="input-field w-full p-2 rounded" oninput="updateContent()">
                    </div>
                    <div>
                        <label class="block text-gray-500">Entreno</label>
                        <input type="number" id="edit-price-train" class="input-field w-full p-2 rounded" oninput="updateContent()">
                    </div>
                    <div>
                        <label class="block text-gray-500">Combo Oferta</label>
                        <input type="number" id="edit-price-combo" class="input-field w-full p-2 rounded" oninput="updateContent()">
                    </div>
                    <div>
                        <label class="block text-gray-500">Combo Original</label>
                        <input type="number" id="edit-price-old" class="input-field w-full p-2 rounded" oninput="updateContent()">
                    </div>
                </div>
            </div>

            <div class="border-t border-gray-700 pt-4 mt-4">
                <label class="block text-gray-500 mb-1">Nota del Combo (Debajo del bot√≥n)</label>
                <textarea id="edit-combo-note" class="input-field w-full p-2 rounded h-20" oninput="updateContent()"></textarea>
            </div>

            <div class="bg-infit-pink/10 p-3 rounded mt-6 border border-infit-pink/20">
                <p class="text-[10px] text-gray-300 mb-2">
                    <i class="fas fa-info-circle text-infit-pink"></i> 
                    Los cambios son solo visuales. Copia el c√≥digo para guardarlos en GitHub.
                </p>
                <button onclick="copyConfig()" class="w-full bg-infit-pink text-white font-bold py-2 rounded text-[10px] uppercase hover:bg-white hover:text-infit-pink transition-colors">
                    Copiar C√≥digo de Configuraci√≥n
                </button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-white/5">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fas fa-bolt text-infit-pink text-xl animate-pulse-slow"></i>
                <h1 class="text-2xl font-heading font-bold italic tracking-wider text-white">
                    IN<span class="text-infit-gold">FIT</span> <span class="text-xs not-italic text-gray-500 ml-1">MX</span>
                </h1>
            </div>
            <div id="affiliate-badge" class="hidden text-[10px] text-gray-400 uppercase border border-gray-800 rounded-full px-3 py-1 bg-black/50">
                Recomendada por: <span id="affiliate-name" class="text-white font-bold"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="pt-32 pb-12 px-4 text-center max-w-4xl mx-auto relative">
        <div class="absolute top-20 left-1/2 transform -translate-x-1/2 w-64 h-64 bg-infit-pink opacity-5 blur-[100px] rounded-full pointer-events-none"></div>
        
        <h2 class="text-4xl md:text-6xl font-heading font-bold uppercase italic mb-4 animate-float">
            Bienvenida al inicio de<br>
            <span class="text-infit-pink text-glow">Tu Mejor Versi√≥n</span>
        </h2>
        
        <div class="inline-block bg-infit-pink/10 border border-infit-pink/20 rounded-lg px-6 py-2 mb-8 animate-pulse-slow">
            <p class="text-infit-pink text-xs md:text-sm font-bold uppercase tracking-widest">
                <i class="fas fa-handshake mr-2"></i> <span id="display-promo">Garant√≠a Total: Paga hasta recibir tu plan</span>
            </p>
        </div>
    </header>

    <!-- Pricing Plans Section -->
    <main class="max-w-6xl mx-auto px-4 pb-24 grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 items-start">
        
        <!-- Plan Nutrici√≥n -->
        <div class="glass-panel rounded-2xl p-6 relative group hover:bg-white/5 transition-all duration-300 order-2 md:order-1">
            <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 bg-infit-dark border border-white/10 p-3 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.05)]">
                <i class="fas fa-leaf text-2xl text-infit-pink"></i>
            </div>
            <h3 class="mt-8 text-xl font-heading font-bold text-center text-white uppercase italic">Nutrici√≥n</h3>
            <div class="text-center my-4">
                <span class="text-3xl font-bold text-infit-gold">$<span id="display-price-nutri">600</span></span>
                <span class="text-sm text-gray-500 uppercase">MXN / Mes</span>
            </div>
            <button onclick="playVideo('nutri')" class="w-full mb-4 py-2 bg-black hover:bg-infit-pink/10 rounded text-xs text-infit-pink border border-infit-pink/30 transition-all flex items-center justify-center gap-2">
                <i class="fas fa-play-circle text-sm"></i> Ver Preview
            </button>
            <ul class="space-y-3 text-sm text-gray-400 mb-8">
                <li class="flex items-start gap-2"><i class="fas fa-check text-infit-pink mt-1"></i> Plan 100% personalizado</li>
                <li class="flex items-start gap-2"><i class="fas fa-check text-infit-pink mt-1"></i> Recetas ricas y pr√°cticas</li>
                <li class="flex items-start gap-2"><i class="fas fa-check text-infit-pink mt-1"></i> Enfoque en tus objetivos</li>
            </ul>
            <button onclick="selectPlan('Nutrici√≥n')" class="w-full py-3 rounded-lg border border-gray-600 hover:border-infit-pink hover:text-infit-pink transition-colors text-sm font-bold uppercase tracking-wider text-gray-300">
                Elegir Nutrici√≥n
            </button>
        </div>

        <!-- PLAN COMBO (DESTACADO) -->
        <div class="combo-card rounded-2xl p-8 order-1 md:order-2">
            <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-infit-pink to-[#db2777] text-white font-bold px-4 py-1 rounded-full text-xs uppercase tracking-widest shadow-[0_0_15px_rgba(236,72,153,0.5)]">
                Recomendado M√©xico üá≤üáΩ
            </div>
            <div class="text-center mb-6">
                <i class="fas fa-fire text-4xl text-infit-pink mb-4 animate-pulse-slow"></i>
                <h3 class="text-2xl font-heading font-bold text-white uppercase italic">Combo Total</h3>
                <p class="text-[10px] text-gray-400 uppercase tracking-widest mt-1">La experiencia completa</p>
            </div>
            <div class="text-center my-6 border-y border-infit-pink/20 py-4">
                <div class="flex justify-center items-center gap-2">
                    <span class="text-gray-600 line-through text-lg">$<span id="display-price-old">1800</span></span>
                    <span class="text-5xl font-bold text-white">$<span id="display-price-combo">999</span></span>
                </div>
                <span class="text-sm text-infit-gold font-bold">MXN / Mes</span>
            </div>
            <ul class="space-y-4 text-sm text-gray-300 mb-8">
                <li class="flex flex-col gap-1">
                    <div class="flex items-start gap-3">
                        <div class="bg-infit-pink/20 p-1 rounded text-infit-pink"><i class="fas fa-dumbbell"></i></div>
                        <span class="font-bold text-white">Entrenamiento Digital</span>
                    </div>
                    <button onclick="playVideo('entreno')" class="ml-9 text-[10px] text-infit-pink hover:text-white underline text-left w-fit transition-colors"><i class="fas fa-play text-[8px] mr-1"></i>Ver preview entrenamiento</button>
                </li>
                <li class="flex flex-col gap-1">
                    <div class="flex items-start gap-3">
                        <div class="bg-infit-pink/20 p-1 rounded text-infit-pink"><i class="fas fa-utensils"></i></div>
                        <span class="font-bold text-white">Plan Nutricional Completo</span>
                    </div>
                    <button onclick="playVideo('nutri')" class="ml-9 text-[10px] text-infit-pink hover:text-white underline text-left w-fit transition-colors"><i class="fas fa-play text-[8px] mr-1"></i>Ver preview nutrici√≥n</button>
                </li>
                <li class="flex items-start gap-3">
                    <div class="bg-infit-pink/20 p-1 rounded text-infit-pink"><i class="fas fa-calendar-check"></i></div>
                    <span>Calendario del Poder + Eliminaci√≥n alimentos da√±inos</span>
                </li>
            </ul>
            <button onclick="selectPlan('Combo Total')" class="w-full bg-infit-pink hover:bg-white hover:text-infit-pink text-white font-bold py-4 rounded-lg uppercase tracking-widest transition-all transform hover:scale-105 shadow-[0_0_20px_rgba(236,72,153,0.3)]">
                ¬°Lo Quiero Todo!
            </button>
            <p class="text-[10px] text-center text-gray-500 mt-4 italic" id="display-combo-note">
                *Pagas hasta que te entreguemos todo tu material.*
            </p>
        </div>

        <!-- Plan Entrenamiento -->
        <div class="glass-panel rounded-2xl p-6 relative group hover:bg-white/5 transition-all duration-300 order-3">
            <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 bg-infit-dark border border-white/10 p-3 rounded-full">
                <i class="fas fa-dumbbell text-2xl text-infit-pink"></i>
            </div>
            <h3 class="mt-8 text-xl font-heading font-bold text-center text-white uppercase italic">Entrenamiento</h3>
            <div class="text-center my-4">
                <span class="text-3xl font-bold text-infit-gold">$<span id="display-price-train">600</span></span>
                <span class="text-sm text-gray-500 uppercase">MXN / Mes</span>
            </div>
            <button onclick="playVideo('entreno')" class="w-full mb-4 py-2 bg-black hover:bg-infit-pink/10 rounded text-xs text-infit-pink border border-infit-pink/30 transition-all flex items-center justify-center gap-2">
                <i class="fas fa-play-circle text-sm"></i> Ver Preview
            </button>
            <ul class="space-y-3 text-sm text-gray-400 mb-8">
                <li class="flex items-start gap-2"><i class="fas fa-check text-infit-pink mt-1"></i> Rutinas Gym o Casa</li>
                <li class="flex items-start gap-2"><i class="fas fa-check text-infit-pink mt-1"></i> Videos demostrativos</li>
                <li class="flex items-start gap-2"><i class="fas fa-check text-infit-pink mt-1"></i> Calendario de Poder</li>
            </ul>
            <button onclick="selectPlan('Entrenamiento')" class="w-full py-3 rounded-lg border border-gray-600 hover:border-infit-pink hover:text-infit-pink transition-colors text-sm font-bold uppercase tracking-wider text-gray-300">
                Elegir Entrenamiento
            </button>
        </div>

    </main>

    <!-- Footer Notes (Bloques Separados) -->
    <div class="max-w-4xl mx-auto px-6 pb-12">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            
            <!-- Bloque 1: Garant√≠a M√©xico -->
            <div class="bg-gray-900/50 border border-infit-pink/30 p-4 rounded-xl flex flex-col items-center justify-center text-center gap-2">
                <i class="fas fa-shield-alt text-infit-pink text-2xl animate-pulse"></i>
                <p class="text-xs text-gray-400">
                    <strong class="text-white uppercase">Confianza INFIT M√©xico:</strong><br>
                    Nosotros confiamos en ti. Solicita tu plan hoy, y realiza tu pago √∫nicamente cuando hayas recibido tu material completo.
                </p>
            </div>

            <!-- Bloque 2: Aviso USA (LEYENDA AJUSTADA) -->
            <div class="bg-gray-900/80 border border-gray-700 p-4 rounded-xl flex flex-col items-center justify-center text-center gap-2 relative overflow-hidden">
                <div class="absolute top-0 right-0 text-6xl text-white opacity-[0.05] pointer-events-none grayscale"><i class="fas fa-flag-usa"></i></div>
                
                <i class="fas fa-globe-americas text-white text-2xl"></i>
                <p class="text-xs text-gray-400">
                    <strong class="text-white uppercase">üá∫üá∏ Paisanos en EE.UU.</strong><br>
                    El precio se ajusta por soporte tecnol√≥gico, env√≠os y comisiones de transferencia internacional.
                </p>
            </div>

        </div>
    </div>

    <!-- Modal Formulario (Pedido) -->
    <div id="order-modal" class="fixed inset-0 z-[100] hidden overflow-y-auto">
        <div class="fixed inset-0 bg-black/95 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="relative min-h-screen md:min-h-0 flex items-end md:items-center justify-center p-0 md:p-4">
            <div class="w-full md:w-[500px] bg-[#0a0a0a] border border-white/10 rounded-t-3xl md:rounded-2xl p-6 md:p-8 transition-transform duration-300 transform translate-y-full md:translate-y-0" id="modal-panel">
                
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-heading font-bold text-white uppercase italic">Solicitud de Plan</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-white"><i class="fas fa-times text-xl"></i></button>
                </div>

                <div class="bg-white/5 p-3 rounded border border-white/10 mb-6 flex justify-between items-center">
                    <div>
                        <p class="text-[10px] text-gray-400 uppercase font-bold">Plan Seleccionado</p>
                        <p id="modal-plan-name" class="text-white font-bold text-lg leading-none">Combo Total</p>
                    </div>
                    <div class="text-right">
                        <p id="modal-plan-price" class="text-infit-gold font-bold text-xl">$999</p>
                        <p class="text-[9px] text-gray-500 uppercase">A pagar al recibir</p>
                    </div>
                </div>

                <form id="client-form" onsubmit="handleOrder(event)" class="space-y-4 max-h-[70vh] overflow-y-auto pr-2 custom-scrollbar">
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-xs text-gray-500 uppercase font-bold mb-1">Nombre Completo</label>
                            <input type="text" id="client-name" required class="input-field w-full rounded p-3" placeholder="Ej. Ana Garc√≠a">
                        </div>
                        <div>
                            <label class="block text-xs text-gray-500 uppercase font-bold mb-1">Colonia y Ciudad</label>
                            <input type="text" id="client-origin" required class="input-field w-full rounded p-3" placeholder="Ej. Centro, Santa Ana Hueytlalpan">
                        </div>
                        <div>
                            <label class="block text-xs text-gray-500 uppercase font-bold mb-1">¬øQui√©n te recomend√≥? (Opcional)</label>
                            <input type="text" id="client-referrer" class="input-field w-full rounded p-3" placeholder="Nombre de tu amiga">
                        </div>
                    </div>

                    <div id="fields-nutrition" class="hidden space-y-4 border-t border-gray-800 pt-4">
                        <div class="flex justify-between items-center">
                            <p class="text-white text-xs font-bold uppercase"><i class="fas fa-apple-alt mr-1"></i> Datos Nutricionales</p>
                            <input type="hidden" name="units" value="metric">
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2">
                            <div>
                                <label class="block text-[10px] text-gray-500 uppercase font-bold mb-1">Edad</label>
                                <input type="number" id="client-age" class="input-field w-full rounded p-2 text-sm" placeholder="25">
                            </div>
                            <div>
                                <label class="block text-[10px] text-gray-500 uppercase font-bold mb-1">Peso (kg)</label>
                                <input type="text" id="client-weight" class="input-field w-full rounded p-2 text-sm" placeholder="65">
                            </div>
                            <div>
                                <label class="block text-[10px] text-gray-500 uppercase font-bold mb-1">Estatura (cm)</label>
                                <input type="text" id="client-height" class="input-field w-full rounded p-2 text-sm" placeholder="165">
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs text-gray-500 uppercase font-bold mb-2">Nivel de Actividad</label>
                            <select id="client-activity" class="input-field w-full rounded p-3 text-sm">
                                <option value="" disabled selected>-- Selecciona tu Nivel --</option>
                                <optgroup label="üèÉ HAGO EJERCICIO / DEPORTE">
                                    <option value="Ligero (Ejercicio 1-2 d√≠as)">Ligero (1-2 d√≠as/sem)</option>
                                    <option value="Moderado (Ejercicio 3-4 d√≠as)">Moderado (3-4 d√≠as/sem)</option>
                                    <option value="Intenso (Ejercicio 5+ d√≠as)">Intenso (5+ d√≠as/sem)</option>
                                </optgroup>
                                <optgroup label="üíº NO HAGO EJERCICIO (Vida Diaria)">
                                    <option value="Sedentario (Oficina/Casa)">Sedentario (Oficina/Casa)</option>
                                    <option value="Activo (De pie/Caminar)">Activo (Caminar/Trabajo f√≠sico)</option>
                                    <option value="Muy Activo (Carga pesada)">Muy Activo (Esfuerzo f√≠sico)</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>

                    <div id="fields-training" class="hidden space-y-4 border-t border-gray-800 pt-4">
                        <p class="text-white text-xs font-bold uppercase"><i class="fas fa-dumbbell mr-1"></i> Datos Entrenamiento</p>
                        <div>
                            <label class="block text-xs text-gray-500 uppercase font-bold mb-2">Lugar de Entreno</label>
                            <div class="grid grid-cols-2 gap-2">
                                <label class="cursor-pointer">
                                    <input type="radio" name="place" value="Gimnasio" class="peer hidden" checked>
                                    <div class="input-field p-3 rounded text-center text-xs font-bold peer-checked:border-infit-pink peer-checked:text-infit-pink hover:bg-white/5">
                                        <i class="fas fa-building mb-1 block text-lg"></i> Gimnasio
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="place" value="Casa" class="peer hidden">
                                    <div class="input-field p-3 rounded text-center text-xs font-bold peer-checked:border-infit-pink peer-checked:text-infit-pink hover:bg-white/5">
                                        <i class="fas fa-home mb-1 block text-lg"></i> Casa
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-xs text-gray-500 uppercase font-bold mb-2">D√≠as Disponibles</label>
                            <div class="flex justify-between gap-1">
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="Lun" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">L</div></label>
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="Mar" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">M</div></label>
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="Mi√©" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">M</div></label>
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="Jue" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">J</div></label>
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="Vie" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">V</div></label>
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="S√°b" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">S</div></label>
                                <label class="cursor-pointer flex-1"><input type="checkbox" value="Dom" class="day-checkbox hidden"><div class="input-field h-8 flex items-center justify-center rounded text-[10px]">D</div></label>
                            </div>
                        </div>
                    </div>

                    <div class="pt-4 sticky bottom-0 bg-[#0a0a0a] border-t border-gray-800">
                        <button type="submit" id="submit-btn" class="w-full bg-[#25D366] text-white font-bold py-4 rounded-lg uppercase tracking-widest hover:bg-[#20bd5a] transition-colors flex justify-center items-center gap-2 shadow-[0_0_15px_rgba(37,211,102,0.3)]">
                            <i class="fab fa-whatsapp text-2xl"></i>
                            <span>Pedir Plan por WhatsApp</span>
                        </button>
                        <p class="text-[10px] text-center text-gray-500 mt-2">
                            <i class="fas fa-lock text-infit-gold"></i> Pagar√°s hasta que recibas tu material.
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL DE VIDEO -->
    <div id="video-modal" class="fixed inset-0 z-[120] hidden bg-black/95 flex items-center justify-center p-4">
        <div class="relative w-full max-w-4xl bg-black rounded-lg overflow-hidden border border-white/10 shadow-2xl">
            <button onclick="closeVideo()" class="absolute top-2 right-2 z-10 bg-black/50 text-white hover:text-infit-pink rounded-full w-10 h-10 flex items-center justify-center text-xl backdrop-blur-sm">
                <i class="fas fa-times"></i>
            </button>
            <div class="aspect-video w-full">
                <video id="main-video-player" class="w-full h-full object-contain" controls controlsList="nodownload">
                    <source src="" type="video/mp4">
                    Tu navegador no soporta videos HTML5.
                </video>
            </div>
            <div class="p-4 bg-[#121212]">
                <h4 id="video-title" class="text-white font-bold uppercase text-lg">Vista Previa</h4>
                <p class="text-gray-400 text-xs mt-1">Mira un poco de lo que incluye este plan.</p>
            </div>
        </div>
    </div>

    <!-- Success Overlay -->
    <div id="success-overlay" class="fixed inset-0 z-[110] hidden bg-black flex flex-col items-center justify-center p-4 text-center">
        <div class="bg-infit-pink/20 p-6 rounded-full mb-6 animate-bounce">
            <i class="fas fa-check text-4xl text-infit-pink"></i>
        </div>
        <h2 class="text-3xl font-heading font-bold text-white uppercase italic mb-2">¬°Solicitud Enviada!</h2>
        <p class="text-gray-400 max-w-md mb-8">
            Gracias <span id="success-name" class="text-white font-bold"></span>.
            <br>
            Hemos abierto WhatsApp para que env√≠es tus datos y comencemos a trabajar en tu plan.
        </p>
        <button onclick="location.reload()" class="text-gray-500 hover:text-white underline text-xs">Volver al inicio</button>
    </div>

    <footer class="bg-black py-8 border-t border-white/5 mt-auto">
        <div class="text-center">
            <p class="text-white font-heading font-bold text-xl italic tracking-widest">IN<span class="text-infit-gold">FIT</span></p>
            <p class="text-gray-700 text-[10px] uppercase tracking-widest mt-1">Santa Ana Hueytlalpan ¬∑ Tulancingo ¬∑ M√©xico</p>
            <p class="text-gray-800 text-[9px] mt-4">Desarrollado con ‚ö° para tu Mejor Versi√≥n</p>
        </div>
    </footer>

    <script>
        let config = {
            promoText: "Precios promocion del 12 al 19 de Febrero. Garant√≠a Total: Paga hasta recibir tu plan",
            priceNutri: 390,
            priceTrain: 390,
            priceCombo: 690,
            priceOld: 780,
            comboNote: "*Pagas hasta que te entreguemos todo tu material.*"
        };
        
        let db;
        let auth;
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "AIzaSyAQGBdxeLXvFrhGSgOvDpJbswbeJ3Fi48Y",
            authDomain: "infit-bienvenida-mx.firebaseapp.com",
            projectId: "infit-bienvenida-mx",
            storageBucket: "infit-bienvenida-mx.firebasestorage.app",
            messagingSenderId: "204458486575",
            appId: "1:204458486575:web:57a2a7b62053cd33afcfda"
        };
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'infit-web';

        try {
            if (typeof firebase !== 'undefined' && !firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
                if (typeof __initial_auth_token !== 'undefined') {
                    auth.signInWithCustomToken(__initial_auth_token);
                } else {
                    auth.signInAnonymously().catch(e => console.error("Auth Error", e));
                }
            }
        } catch (e) { console.warn("Modo offline/demo o error config", e); }

        let selectedPlan = { name: '', price: 0 };
        let affiliateCode = null;

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            if (ref) {
                affiliateCode = ref;
                document.getElementById('affiliate-badge').classList.remove('hidden');
                document.getElementById('affiliate-badge').classList.add('inline-block');
                document.getElementById('affiliate-name').textContent = ref;
            }
            const isAdmin = urlParams.get('admin') === 'true';
            if (isAdmin) {
                const adminElements = document.querySelectorAll('.admin-only');
                adminElements.forEach(el => el.style.display = 'block');
            }
            loadConfig();
        });

        function playVideo(type) {
            const modal = document.getElementById('video-modal');
            const video = document.getElementById('main-video-player');
            const title = document.getElementById('video-title');
            let src = '';
            if (type === 'nutri') {
                src = 'PA%20+%20Eliminacion%20Mujeres.mp4';
                title.textContent = "PREVIEW: Plan de Nutrici√≥n";
            } else if (type === 'entreno') {
                src = 'PE%20+%20Reto%20Mujeres.mp4';
                title.textContent = "PREVIEW: Entrenamiento Digital";
            }
            video.src = src;
            modal.classList.remove('hidden');
            video.play().catch(e => console.log("Auto-play prevenido", e));
        }

        function closeVideo() {
            const modal = document.getElementById('video-modal');
            const video = document.getElementById('main-video-player');
            video.pause();
            video.currentTime = 0;
            video.src = "";
            modal.classList.add('hidden');
        }

        function loadConfig() {
            document.getElementById('display-promo').textContent = config.promoText;
            document.getElementById('display-price-nutri').textContent = config.priceNutri;
            document.getElementById('display-price-train').textContent = config.priceTrain;
            document.getElementById('display-price-combo').textContent = config.priceCombo;
            document.getElementById('display-price-old').textContent = config.priceOld;
            document.getElementById('display-combo-note').textContent = config.comboNote;
            document.getElementById('edit-promo').value = config.promoText;
            document.getElementById('edit-price-nutri').value = config.priceNutri;
            document.getElementById('edit-price-train').value = config.priceTrain;
            document.getElementById('edit-price-combo').value = config.priceCombo;
            document.getElementById('edit-price-old').value = config.priceOld;
            document.getElementById('edit-combo-note').value = config.comboNote;
        }

        function updateContent() {
            config.promoText = document.getElementById('edit-promo').value;
            config.priceNutri = document.getElementById('edit-price-nutri').value;
            config.priceTrain = document.getElementById('edit-price-train').value;
            config.priceCombo = document.getElementById('edit-price-combo').value;
            config.priceOld = document.getElementById('edit-price-old').value;
            config.comboNote = document.getElementById('edit-combo-note').value;
            loadConfig();
        }

        function toggleEditor() {
            document.getElementById('editor-panel').classList.toggle('open');
        }

        function copyConfig() {
            const code = `
        let config = {
            promoText: "${config.promoText}",
            priceNutri: ${config.priceNutri},
            priceTrain: ${config.priceTrain},
            priceCombo: ${config.priceCombo},
            priceOld: ${config.priceOld},
            comboNote: "${config.comboNote.replace(/\n/g, '')}"
        };`;
            navigator.clipboard.writeText(code).then(() => {
                alert("C√≥digo copiado al portapapeles.");
            });
        }

        function selectPlan(planName) {
            let price = 0;
            const fieldsNutri = document.getElementById('fields-nutrition');
            const fieldsTrain = document.getElementById('fields-training');
            fieldsNutri.classList.add('hidden');
            fieldsTrain.classList.add('hidden');
            if (planName === 'Nutrici√≥n') {
                price = config.priceNutri;
                fieldsNutri.classList.remove('hidden');
            } else if (planName === 'Entrenamiento') {
                price = config.priceTrain;
                fieldsTrain.classList.remove('hidden');
            } else if (planName === 'Combo Total') {
                price = config.priceCombo;
                fieldsNutri.classList.remove('hidden');
                fieldsTrain.classList.remove('hidden');
            }
            selectedPlan = { name: planName, price: price };
            document.getElementById('modal-plan-name').textContent = planName;
            document.getElementById('modal-plan-price').textContent = `$${price} MXN`;
            const modal = document.getElementById('order-modal');
            const panel = document.getElementById('modal-panel');
            modal.classList.remove('hidden');
            setTimeout(() => panel.classList.remove('translate-y-full'), 10);
        }

        function closeModal() {
            const modal = document.getElementById('order-modal');
            const panel = document.getElementById('modal-panel');
            panel.classList.add('translate-y-full');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        async function handleOrder(e) {
            e.preventDefault();
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Procesando...';
            const referrerInput = document.getElementById('client-referrer').value;
            const finalReferrer = referrerInput || affiliateCode || 'Local/Org√°nico';
            const formData = {
                name: document.getElementById('client-name').value,
                origin: document.getElementById('client-origin').value,
                plan: selectedPlan.name,
                price: selectedPlan.price,
                currency: 'MXN',
                affiliate: finalReferrer,
                timestamp: new Date().toISOString()
            };
            let detailsText = "";
            let unitLabelW = 'kg';
            let unitLabelH = 'cm';
            if (!document.getElementById('fields-nutrition').classList.contains('hidden')) {
                formData.age = document.getElementById('client-age').value;
                formData.weight = document.getElementById('client-weight').value;
                formData.height = document.getElementById('client-height').value;
                formData.activity = document.getElementById('client-activity').value;
                detailsText += `%0A%0Aüçé *DATOS NUTRICI√ìN*%0A‚Ä¢ Edad: ${formData.age} a√±os%0A‚Ä¢ Peso: ${formData.weight} ${unitLabelW}%0A‚Ä¢ Estatura: ${formData.height} ${unitLabelH}%0A‚Ä¢ Actividad: ${formData.activity || 'No especificada'}`;
            }
            if (!document.getElementById('fields-training').classList.contains('hidden')) {
                const place = document.querySelector('input[name="place"]:checked').value;
                const days = Array.from(document.querySelectorAll('.day-checkbox:checked')).map(cb => cb.value).join(', ');
                formData.place = place;
                formData.days = days;
                detailsText += `%0A%0AüèãÔ∏è *DATOS ENTRENO*%0A‚Ä¢ Lugar: ${place}%0A‚Ä¢ D√≠as Disp: ${days || 'Por definir'}`;
            }
            if (db) {
                try {
                    const user = auth.currentUser;
                    const collectionPath = user 
                        ? db.collection('artifacts').doc(appId).collection('public').doc('data').collection('leads')
                        : null;
                    if (collectionPath) await collectionPath.add(formData);
                } catch (error) { console.error("Firebase Error", error); }
            }
            const phone = "527751056744";
            const header = `Hola INFIT! üá≤üáΩ Soy *${formData.name}* (De ${formData.origin}).%0A%0A‚ú® Me interesa el *${formData.plan}* (Precio Promoci√≥n: $${formData.price} MXN).`;
            const refText = finalReferrer !== 'Local/Org√°nico' ? `%0A%0Aü§ù *Vengo recomendada por:* ${finalReferrer}` : '';
            const paymentCondition = `%0A%0A‚úÖ *Confirmaci√≥n:* Estoy enterada que realizar√© mi pago hasta que reciba mi material completo.`;
            const motivation = `%0A%0A‚ú® *¬°Lista para mi mejor Versi√≥n!*`;
            const fullText = `${header}${detailsText}${refText}${paymentCondition}${motivation}`;
            const waLink = `https://wa.me/${phone}?text=${fullText}`;
            window.open(waLink, '_blank');
            closeModal();
            showSuccess(formData.name);
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="fab fa-whatsapp text-2xl"></i><span>Pedir Plan por WhatsApp</span>';
        }

        function showSuccess(name) {
            const overlay = document.getElementById('success-overlay');
            document.getElementById('success-name').textContent = name;
            overlay.classList.remove('hidden');
            const end = Date.now() + 2.5 * 1000;
            const colors = ['#FFD700', '#ec4899', '#ffffff'];
            (function frame() {
                confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 }, colors: colors });
                confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 }, colors: colors });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }
    </script>
</body>
</html>
